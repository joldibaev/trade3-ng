<!-- Header -->
<div class="flex items-center justify-between">
  <div class="flex items-center gap-3">
    <ng-content select="[before-title]" />
    <h1 class="h1">{{ title() }}</h1>
  </div>
  <ng-content select="[header-actions]" />
</div>

<ng-content select="[after-title]" />

<div class="flex flex-1 gap-4 overflow-hidden">
  <!-- Main Content: Table -->
  <ui-card class="flex-1 overflow-hidden">
    <!-- Toolbar -->
    <div class="default-border-color flex items-center justify-between border-b p-2">
      <div class="flex items-center gap-2">
        <button uiButton variant="ghost" size="sm" icon="outline-plus" (click)="handleCreate()">
          Создать
        </button>

        @if (showDetail()) {
          <button
            uiButton
            variant="ghost"
            iconOnly
            icon="outline-eye"
            [disabled]="!selectedItem()"
            (click)="handleDetail()"
          ></button>
        }

        @if (showEdit()) {
          <button
            uiButton
            variant="ghost"
            iconOnly
            icon="outline-edit"
            [disabled]="!selectedItem()"
            (click)="handleEdit()"
          ></button>
        }

        @if (showDelete()) {
          <button
            uiButton
            variant="danger"
            iconOnly
            icon="outline-trash"
            [disabled]="!selectedItem()"
            (click)="handleDelete()"
          ></button>
        }

        <ng-content select="[toolbar-actions]" />

        <!-- v-line -->
        <div class="mx-1 h-4 w-px bg-slate-300"></div>

        @if (isSearchVisible()) {
          <div
            class="animate-in fade-in slide-in-from-right-4 flex items-center gap-1 duration-300"
          >
            <ui-input
              type="search"
              placeholder="Поиск..."
              class="w-64"
              [formField]="formData.query"
            />
            <button
              uiButton
              variant="ghost"
              iconOnly
              icon="outline-x"
              (click)="toggleSearch()"
            ></button>
          </div>
        } @else {
          <button uiButton variant="ghost" size="sm" icon="outline-search" (click)="toggleSearch()">
            Найти
          </button>
        }
      </div>
    </div>

    <!-- Table -->
    <ui-table
      [columns]="columns()"
      [data]="data()"
      [trackField]="trackField()"
      [loading]="isLoading()"
      (selectedChanged)="selectedItem.set($event)"
    />
  </ui-card>
</div>
