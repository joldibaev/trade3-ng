<ui-card>
  <!-- Store Card Header -->
  <div class="border-b border-slate-200 p-6">
    <div class="mb-4 flex items-start justify-between">
      <div class="flex items-start gap-4">
        <!-- icon -->
        <div
          class="rounded-squircle from-primary-500 to-primary-600 flex h-12 w-12 shrink-0 items-center justify-center bg-linear-to-br text-white shadow-sm"
        >
          <ui-icon name="outline-building-store" width="20" height="20" />
        </div>

        <div>
          <div class="mb-1 flex items-center gap-2">
            <h3 class="truncate text-lg font-semibold">
              {{ store().name }}
            </h3>
            @if (store().isActive) {
              <ui-badge variant="success" size="sm">Активен</ui-badge>
            } @else {
              <ui-badge variant="neutral" size="sm">Неактивен</ui-badge>
            }
          </div>
          <div class="flex flex-col gap-1 text-sm text-slate-600">
            @if (store().address) {
              <div class="flex items-center gap-1.5 grayscale">
                <ui-icon name="outline-map-pin" width="14" height="14" />
                <span>{{ store().address }}</span>
              </div>
            }
            @if (store().phone) {
              <div class="flex items-center gap-1.5 grayscale">
                <ui-icon name="outline-phone" width="14" height="14" />
                <span>{{ store().phone }}</span>
              </div>
            }
            @if (store().workingHours) {
              <div class="flex items-center gap-1.5 grayscale">
                <ui-icon name="outline-clock" width="14" height="14" />
                <span>{{ store().workingHours }}</span>
              </div>
            }
          </div>
        </div>
      </div>
      <div class="flex items-center gap-1">
        <button
          uiButton
          variant="ghost"
          iconOnly
          icon="outline-edit"
          class="h-8 w-8 text-slate-600"
          (click)="edit.emit()"
        ></button>
        <button
          uiButton
          variant="danger"
          iconOnly
          icon="outline-trash"
          class="h-8 w-8"
          (click)="delete.emit()"
        ></button>
      </div>
    </div>

    <!-- Store Mini Stats -->
    <div class="flex border-t border-slate-100 pt-4 text-left">
      <div>
        <p class="text-[11px] font-medium tracking-wide text-slate-500 uppercase">
          Продажи за сегодня
        </p>
        <p class="mt-0.5 text-sm font-semibold text-emerald-600">2,450,000 UZS</p>
      </div>
    </div>
  </div>

  <!-- Cashboxes Section -->
  <div>
    <button
      class="flex w-full items-center justify-between border-t border-slate-100 bg-slate-50 px-6 py-3 transition-colors hover:bg-slate-100"
      (click)="expanded.set(!expanded())"
    >
      <div class="flex items-center gap-2 text-sm font-medium">
        <ui-icon name="outline-device-desktop" width="16" height="16" class="text-slate-600" />
        <span>Кассы ({{ store().cashboxes.length || 0 }})</span>
      </div>
      <ui-icon
        name="outline-chevron-down"
        width="16"
        height="16"
        class="default-transition text-slate-500"
        [class.-rotate-180]="expanded()"
      />
    </button>

    @if (expanded()) {
      <div class="p-6">
        @if (!store().cashboxes || store().cashboxes.length === 0) {
          <div class="flex flex-col items-center justify-center py-8 text-center">
            <ui-icon
              name="outline-device-desktop"
              width="48"
              height="48"
              class="mb-3 text-slate-300"
            />
            <p class="text-sm text-slate-500">Кассы не настроены</p>
            <button
              uiButton
              variant="ghost"
              size="sm"
              class="mt-3 text-emerald-600 hover:text-emerald-700"
              (click)="addCashbox.emit()"
            >
              Добавить первую кассу
            </button>
          </div>
        } @else {
          <div class="flex flex-col gap-3">
            @for (cashbox of store().cashboxes; track cashbox.id) {
              <app-cashbox-list-item
                [cashbox]="cashbox"
                (edit)="editCashbox.emit(cashbox)"
                (delete)="deleteCashbox.emit(cashbox)"
              />
            }
            <button
              uiButton
              variant="dashed"
              icon="outline-plus"
              fluid
              class="py-3"
              (click)="addCashbox.emit()"
            >
              Добавить кассу
            </button>
          </div>
        }
      </div>
    }
  </div>
</ui-card>
